---
title: "Data Input Lab - Key"
output: html_document
editor_options: 
  chunk_output_type: console
---

In this lab you can use the interactive console to explore or **Knit** the document. 
Remember anything you type here can be "sent" to the console with Cmd-Enter (OS-X) or Ctrl-Enter (Windows/Linux) in an R code chunk.

```{r}
library(readr)
```

# Part 1  

### 1.1 

Set up your R Project. Once complete, confirm you have created a project folder.

- First, save your files.
- Click on the R Project button (blue box with a green plus sign on the top left).
- If prompted, don't save your .Rdata
- Click "New Directory"
- Click "New Project"
- Name the Directory (folder) and select an appropriate location (such as Desktop)

### 1.2

Use the manual import method (File > Import Dataset > From Text (`readr`)) to read in Haloacetic Acids (HAA5) Exposure for WA Populations on Public Water Systems data from this URL:

https://daseh.org/data/HAA5_Exposure_for_WA_Public_Water_Systems_data.csv.

These data were collected by the Washington Tracking Network. You can learn more about the data here: https://fortress.wa.gov/doh/wtn/WTNPortal/#!q0=674

### 1.3

What is the dataset object called? You can find this information in the Console or the Environment. Enter your answer as a comment using `#`.

```{r 1.3response}
HAA5_Exposure_for_WA_Public_Water_Systems_data
```

### 1.4

Preview the data by clicking the table button in the Environment. How many observations and variables are there? Enter your answer as a comment using `#`.

```{r 1.4response}
# 33 obs of 11 variables
```


# Part 2

### 2.1

Read Haloacetic Acids (HAA5) Exposure for WA Populations on Public Water Systems data from https://daseh.org/data/HAA5_Exposure_for_WA_Public_Water_Systems_data.csv.
and assign it to an object named `haa5`. Use the code structure below.

```
# General format
library(readr)
# OBJECT <- read_csv(FILE)
```

```{r 2.1response}
library(readr)
haa5 <- read_csv(file = "https://daseh.org/data/HAA5_Exposure_for_WA_Public_Water_Systems_data.csv")
```

### 2.2

Load the `readxl` package with the `library()` command. 

If it is not installed, install it via: `RStudio --> Tools --> Install Packages`. You can also try `install.packages("readxl")`.

```{r 2.2response}
library(readxl)
```

### 2.3

The Washington Tracking Network also collects data on nitrate levels in the public water systems. More information on this data can be found here: https://fortress.wa.gov/doh/wtn/WTNPortal/#!q0=685

We've downloaded this dataset already and have saved it as an Excel file. Download the dataset of asthma prevalence in the USA from: https://daseh.org/data/Nitrate_Exposure_for_WA_Public_Water_Systems_data.xlsx file to `nitrate.xlsx` by running the following code chunk. This only downloads the file, it does NOT bring the file into R.

```{r}
download.file(
  url = "https://daseh.org/data/Nitrate_Exposure_for_WA_Public_Water_Systems_data.xlsx",
  destfile = "nitrate.xlsx",
  overwrite = TRUE,
  mode = "wb"
)
```

Note: the "wb" option makes sure the file can be read correctly on Windows machines.

### 2.4

Use the `read_excel()` function in the `readxl` package to read the `nitrate.xlsx` file and call the output `nitrate`. 

```{r 2.4response}
nitrate <- read_excel(path = "nitrate.xlsx")
```


# Practice on Your Own!

### P.1

Let's practice with data about CO2 emissions over time that was curated as part of the Open Case Studies project (https://www.opencasestudies.org/ocs-bp-co2-emissions/).

Run the following code - is there a problem? How do you know?

```{r}
co2 <- read_delim("https://daseh.org/data/Yearly_CO2_Emissions_1000_tonnes.csv", delim = "\t")
co2
```

```{r P1response}
# It should be a red flag to see that there is only one column that looks like: "country,1751,1752,1753..."
# This file is comma delimited not tab delimited!
```

### P.2

By default, R reads the first sheet of an excel file. Copy your code from question 2.4 and add the following argument: `sheet = 2`. Inspect the data using `head()`.

```{r P2response}
nitrate <- read_excel(path = "nitrate.xlsx", sheet = 2)
head(nitrate)
```

### P.3

Install and load the `haven` package. Look at the help page for `read_dta()` function, and scroll to the very bottom of the page. Try running some of the examples provided.

```{r eval = FALSE, label = 'P3response'}
install.packages("haven")
library(haven)
?read_dta

path <- system.file("examples", "iris.dta", package = "haven")
read_dta(path)
```

### P.4 

Learn your working directory by running `getwd()`

```{r P4aresponse}
getwd()
```

Create a folder in your R project called data. Move the "nitrate.xlsx" file there. 

Modify the following code so that it finds "nitrate.xlsx" in the "data" directory.

```
nitrate <- read_excel(path = "nitrate.xlsx")
```

```{r eval=FALSE, label = 'P4bresponse'}
nitrate <- read_excel(path = "data/nitrate.xlsx")
```

### P.5

Practice importing a dataset of your choice, give it an object name, and use `head()` to preview the first few lines.

